<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<link rel="stylesheet" href="/js/prism/prism.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="# æœ¬æ–‡æ”¶è·ä¸ä»·å€¼ å®Œæˆä»£ç åæ‚¨å°†æ”¶è·ä»¥ä¸‹ç•Œé¢ï¼š">
<meta property="og:type" content="article">
<meta property="og:title" content="Flutterä¸­ä½¿ç”¨ç²¾çµå›¾">
<meta property="og:url" content="http://yoursite.com/2020/04/12/flutter%E4%BD%BF%E7%94%A8%E7%B2%BE%E7%81%B5%E5%9B%BE(sprites)/index.html">
<meta property="og:site_name" content="æ¬¢è¿æ¥åˆ°CodingKunçš„åšå®¢">
<meta property="og:description" content="# æœ¬æ–‡æ”¶è·ä¸ä»·å€¼ å®Œæˆä»£ç åæ‚¨å°†æ”¶è·ä»¥ä¸‹ç•Œé¢ï¼š">
<meta property="og:image" content="https://github.com/gitKun/ctrip_gird_demo/blob/master/screenshort/sprites_completed.png?raw=true">
<meta property="og:image" content="https://github.com/gitKun/ctrip_gird_demo/blob/master/images/un_ico_subnav.png?raw=true">
<meta property="og:image" content="https://github.com/gitKun/ctrip_gird_demo/blob/master/screenshort/sprites_test_show.png?raw=true">
<meta property="og:image" content="https://github.com/gitKun/ctrip_gird_demo/blob/master/screenshort/sprites_complet_new.png?raw=true">
<meta property="article:published_time" content="2020-04-12T09:34:16.000Z">
<meta property="article:modified_time" content="2020-04-25T07:20:23.515Z">
<meta property="article:author" content="CodingKun">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/gitKun/ctrip_gird_demo/blob/master/screenshort/sprites_completed.png?raw=true">

<link rel="canonical" href="http://yoursite.com/2020/04/12/flutter%E4%BD%BF%E7%94%A8%E7%B2%BE%E7%81%B5%E5%9B%BE(sprites)/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>Flutterä¸­ä½¿ç”¨ç²¾çµå›¾ | æ¬¢è¿æ¥åˆ°CodingKunçš„åšå®¢</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æ¬¢è¿æ¥åˆ°CodingKunçš„åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">SwiftUI, Flutter...</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/12/flutter%E4%BD%BF%E7%94%A8%E7%B2%BE%E7%81%B5%E5%9B%BE(sprites)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CodingKun">
      <meta itemprop="description" content="å–œæ¬¢æ–°æŠ€æœ¯ï¼Œä¸ºäº†æ›´å¥½åœ°è‡ªå·±åŠªåŠ›å·¥ä½œï¼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ¬¢è¿æ¥åˆ°CodingKunçš„åšå®¢">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Flutterä¸­ä½¿ç”¨ç²¾çµå›¾
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-12 17:34:16" itemprop="dateCreated datePublished" datetime="2020-04-12T17:34:16+08:00">2020-04-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-25 15:20:23" itemprop="dateModified" datetime="2020-04-25T15:20:23+08:00">2020-04-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Flutter/" itemprop="url" rel="index"><span itemprop="name">Flutter</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="æœ¬æ–‡æ”¶è·ä¸ä»·å€¼"><a href="#æœ¬æ–‡æ”¶è·ä¸ä»·å€¼" class="headerlink" title="# æœ¬æ–‡æ”¶è·ä¸ä»·å€¼"></a># æœ¬æ–‡æ”¶è·ä¸ä»·å€¼</h3><ol>
<li><p>å®Œæˆä»£ç åæ‚¨å°†æ”¶è·ä»¥ä¸‹ç•Œé¢ï¼š</p>
 <img width=375 src="https://github.com/gitKun/ctrip_gird_demo/blob/master/screenshort/sprites_completed.png?raw=true" />

<a id="more"></a>
</li>
<li><p>æœ¬æ–‡æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹ï¼š</p>
<ul>
<li><p><code>FutureBuilder</code>;</p>
</li>
<li><p><code>CustomPaint</code> ä¸ <code>CustomPainter</code>;</p>
</li>
<li><p><code>canvas.drawImageRect</code>,<code>ImageStream</code>ç­‰;</p>
<p>æœ€ç»ˆä½ å°†èƒ½å¤Ÿå§ä¸‹é¢çš„ç²¾çµå›¾æŒ‰éœ€å±•ç¤ºï¼š</p>
<img width=58 src="https://github.com/gitKun/ctrip_gird_demo/blob/master/images/un_ico_subnav.png?raw=true">

</li>
</ul>
</li>
</ol>
<h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="# å‡†å¤‡å·¥ä½œ"></a># å‡†å¤‡å·¥ä½œ</h3><p><strong>å¤‡æ³¨ï¼š</strong>æœ¬äººçš„å†™ä½œæ–¹å¼å†³å®šè¿™å¹¶ä¸æ˜¯ä¸€ç¯‡å¯ä»¥ç›´æ¥ç›´æ¥é˜…è¯»å°±èƒ½è·å–åˆ°å…¨éƒ¨ä»£ç çš„æ–‡ç« ï¼Œåå‘äºé¼“åŠ±æ‚¨èƒ½å®é™…åŠ¨æ‰‹æ“ç»ƒä¸€ä¸‹ã€‚</p>
<p>æœ¬æ–‡æ˜¯åœ¨å‰ä½œ<a href="https://gitkun.github.io/2020/04/10/Flutter%E5%AE%9E%E7%8E%B0%E6%90%BA%E7%A8%8BGirdNav%E5%B8%83%E5%B1%80_hotel%E5%B8%83%E5%B1%80/" target="_blank" rel="noopener">æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°æºç¨‹GridNavå¸ƒå±€-hotelå¸ƒå±€</a>çš„ä»£ç åŸºç¡€ä¸Šè¿›è¡Œçš„ï¼Œå½“ç„¶æ‚¨ä¹Ÿå¯ä»¥é‡å¼€ä¸€ä¸ªé¡¹ç›®ï¼Œå³å°†è¦åšçš„äº‹æƒ…å’Œå‰æ–‡å¹¶æ— å…³è”æ€§ï¼Œå¥½çš„è®©æˆ‘ä»¬å¼€å§‹å§ï¼›</p>
<h5 id="å¿…å¤‡æ¡ä»¶"><a href="#å¿…å¤‡æ¡ä»¶" class="headerlink" title="å¿…å¤‡æ¡ä»¶"></a>å¿…å¤‡æ¡ä»¶</h5><ol>
<li><p>å·²æœ‰çš„<code>ctrip_gird_demo</code>å·¥ç¨‹(æˆ–è€…æ–°å»ºä¸€ä¸ªå·¥ç¨‹)ï¼› </p>
</li>
<li><p><a href="http://pic.c-ctrip.com/platform/h5/home/un_ico_subnav2x@v7.152.png" target="_blank" rel="noopener">ç²¾çµå›¾ä¸‹è½½åœ°å€</a>;</p>
<p> å¦‚æœå¤±æ•ˆè¯·åœ¨<a href="https://github.com/gitKun/ctrip_gird_demo/blob/master/images/un_ico_subnav.png" target="_blank" rel="noopener">gitä»“åº“</a>ä¸­ä¸‹è½½;</p>
</li>
</ol>
<h5 id="æ·»åŠ -sub-nav-å’Œç›¸å…³èµ„æº"><a href="#æ·»åŠ -sub-nav-å’Œç›¸å…³èµ„æº" class="headerlink" title="æ·»åŠ  sub_nav å’Œç›¸å…³èµ„æº"></a>æ·»åŠ  sub_nav å’Œç›¸å…³èµ„æº</h5><ol>
<li><p>åœ¨ <code>lib</code> åŒç›®å½•ä¸‹æ–°å»º <code>images</code> ç›®å½•ï¼Œå¹¶å°†ä¸‹è½½çš„ç²¾çµå›¾æ”¹åä¸º <code>un_ico_subnav.png</code> åæ”¾å…¥ <code>images</code> ;</p>
</li>
<li><p>åœ¨ <code>lib</code> ç›®å½•ä¸‹æ–°å»º <code>sub_nav</code> æ–‡ä»¶å¤¹ï¼Œåœ¨ <code>sub_nav</code> ç›®å½•ä¸‹æ–°å»º <code>sub_nav_widget.dart</code> å’Œ <code>sub_nav_sprites_image.dart</code> æ–‡ä»¶;</p>
</li>
<li><p>åœ¨ <code>pubspec.yaml</code> ä¸­æ·»åŠ èµ„æºä¾èµ–:</p>
<pre><code class="line-numbers language-dart"> assets:
   - images/un_ico_subnav.png</code></pre>
<p> ç„¶å <code>cmd</code> + <code>s</code>, <code>VSCode</code> å°†ä¼šè¿è¡Œ <code>flutter packages get</code> å‘½ä»¤;</p>
</li>
</ol>
<h3 id="ä»£ç éƒ¨åˆ†"><a href="#ä»£ç éƒ¨åˆ†" class="headerlink" title="# ä»£ç éƒ¨åˆ†"></a># ä»£ç éƒ¨åˆ†</h3><p>åœ¨ <code>flutter</code> è¦æƒ³ç²¾ç¡®çš„è‡ªå·±æ§åˆ¶å›¾ç‰‡çš„æ˜¾ç¤ºæ•ˆæœï¼Œå¿…é¡»å€ŸåŠ©äº <code>dart:ui</code> æä¾›çš„ <code>ui.Canvas</code> æ¥è¿›è¡Œè‡ªå®šä¹‰çš„ç»˜åˆ¶æ“ä½œï¼Œå¸¸ç”¨æ–¹æ³•ä¸º <code>void drawImageRect(Image image, Rect src, Rect dst, Paint paint) {}</code> , è¿™é‡Œçš„ <code>Image</code> ä¸º <code>ui.Image</code> ç±»å‹ï¼› è€Œæˆ‘ä»¬åœ¨ <code>Flutter</code> å±‚ä½¿ç”¨çš„ <code>Image</code> éœ€è¦å…ˆè½¬æ¢ä¸º <code>ImageStream</code> ç±»å‹ï¼Œç„¶ååé€šè¿‡å…¶ <code>addlistener()</code>æ–¹æ³•ï¼Œæ·»åŠ  <code>ImageStreamListener</code> ç±»å‹çš„å®ä¾‹ï¼Œä¹‹ååœ¨ <code>ImageStreamListener</code> å®ä¾‹çš„å®Œæˆçš„å›è°ƒä¸­é€šè¿‡å›è°ƒå‡½æ•°ä¸­ <code>ImageInfo</code> çš„ <code>image</code> å±æ€§è·å¾— <code>Canvas</code> ç»˜åˆ¶æ—¶éœ€è¦çš„ <code>ui.Image</code>;( <code>iOS</code> çš„ <code>UIImage</code> ä¸ <code>CGImage</code> ï¼Ÿ)</p>
<ol>
<li><p>åœ¨ <code>sub_nav_sprites_image.dart</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç </p>
<pre><code class="line-numbers language-dart"> import &#39;package:flutter/material.dart&#39;;

 class SubNavSpritesImage extends StatefulWidget {
   final int showIndex;
   final ui.Image img;

   SubNavSpritesImage({
     Key key,
     @required this.showIndex,
     @required this.img,
   }) : super(key: key);

   @override
   _SubNavSpritesImageState createState() =&gt; _SubNavSpritesImageState();
 }

 class _SubNavSpritesImageState extends State&lt;SubNavSpritesImage&gt; {
   @override
   Widget build(BuildContext context) {
     return Container(
       width: 28,
       height: 28,
       // todo: add customPaint
     );
   }
 }</code></pre>
<p> è¿™é‡Œæˆ‘ä»¬å…ˆä¸æ€¥ç€å»å®ç°è‡ªå®šä¹‰ç»˜åˆ¶ï¼Œè®©æˆ‘ä»¬å…ˆè·å– <code>ui.Image</code>;</p>
</li>
<li><p>åœ¨ <code>sub_nav_widget.dart</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="line-numbers language-dart"> import &#39;package:flutter/material.dart&#39;;
 import &#39;package:ctrip_gird_demo/sub_nav/sub_nav_sprites_image.dart&#39;;
 import &#39;dart:ui&#39; as ui;
 import &#39;dart:async&#39;;// show Completer

 class SubNavWidget extends StatelessWidget {

   // å›¾æ ‡å¯¹åº”çš„åç§° 
   final List&lt;String&gt; _names = [
     &#39;è‡ªç”±è¡Œ&#39;,
     &#39;Wifiç”µè¯æœ¬&#39;,
     &#39;ä¿é™©Â·ç­¾è¯&#39;,
     &#39;æ¢é’Â·è´­ç‰©&#39;,
     &#39;å½“åœ°å‘å¯¼&#39;,
     &#39;ç‰¹ä»·æœºç¥¨&#39;,
     &#39;ç¤¼å“å¡&#39;,
     &#39;ç”³å¡Â·å€Ÿé’±&#39;,
     &#39;æ—…æ‹&#39;,
     &#39;æ›´å¤š&#39;,
   ];

   // æ¯è¡Œçš„ä¸ªæ•° 
   // todo: modify 5
   final int _rowItemsNum = 5;

   @override
   Widget build(BuildContext context) {
     return FutureBuilder&lt;ui.Image&gt;(
       future: _loadSubNavImageByProvider(
         AssetImage(&#39;images/un_ico_subnav.png&#39;),
       ),
       builder: (context, snapshot) {
         return Container(
             // todo: show SubNavSpritesImage
         );
       },
     );
   }

   // todo: reader ui.Image
   Future&lt;ui.Image&gt; _loadSubNavImageByProvider(
     ImageProvider provider, {
     ImageConfiguration config = ImageConfiguration.empty,
   }) async {
     return null;
   }
</code></pre>
<p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼€å§‹é€šè¿‡ <code>AssetImage</code> æ¥è·å– <code>ui.Image</code>ï¼Œå¦‚æœæ‚¨æœ‰ç–‘é—®çš„è¯å¯ä»¥æŒ‰ä½ <code>cmd</code> ç‚¹å‡» <code>ImageProvider</code> ç„¶åå¾€ä¸Šç¿»ï¼ŒæŸ¥çœ‹å®˜æ–¹ç»™å‡ºçš„ä¾‹å­ï¼› </p>
</li>
<li><p>å°† <code>// todo: reader ui.Image</code> æ›¿æ¢ä¸ºå¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="line-numbers language-dart"> Future&lt;ui.Image&gt; _loadSubNavImageByProvider(
   ImageProvider provider, {
   ImageConfiguration config = ImageConfiguration.empty,
 }) async {
   // å¼‚æ­¥ éœ€è¦å¯¼å…¥ `dart:async`
   Completer&lt;ui.Image&gt; completer = Completer&lt;ui.Image&gt;(); //å®Œæˆçš„å›è°ƒ
   ImageStream stream = provider.resolve(config); //è·å–å›¾ç‰‡æµ
   ImageStreamListener listener;// å…ˆå£°æ˜
   // ç”Ÿæˆä¸€ä¸ªç›‘å¬å¯¹è±¡ï¼Œåªå…³å¿ƒå®Œæˆçš„å›è°ƒï¼Œå¿½ç•¥ onError å›è°ƒ
   listener = ImageStreamListener(
     (ImageInfo frame, bool sync) {
       // å®Œæˆåé€šè¿‡ frame è·å–åˆ° ui.Image
       final ui.Image image = frame.image;
       completer.complete(image); //å®Œæˆ
       stream.removeListener(listener); //ç§»é™¤ç›‘å¬
     },
     // node: ignore `onError` and `onChunk`.
   );
   stream.addListener(listener); //æ·»åŠ ç›‘å¬
   return completer.future;
 }</code></pre>
</li>
<li><p>å°† <code>// todo: show SubNavSpritesImage</code> æ›¿æ¢ä¸ºï¼š</p>
<pre><code class="line-numbers language-dart"> // todo: modify column
 alignment: Alignment.center,
 child: SubNavSpritesImage(
   showIndex: 2,
   img: snapshot.data,
 ),</code></pre>
</li>
<li><p>åœ¨ <code>sub_nav_sprites_image.dart</code> ä¸­å¢åŠ è‡ªå®šä¹‰ç»˜åˆ¶çš„ä»£ç ï¼š</p>
<pre><code class="line-numbers language-dart"> lass _SpritesPainter extends CustomPainter {

   final ui.Image _img; // å›¾ç‰‡
   Paint mainPaint;

   int _showIndex = 0;

   _SpritesPainter(
     this._img, {
     @required int showIndex,
   }) {
     this._showIndex = showIndex;
     mainPaint = Paint();
   }

   @override
   void paint(ui.Canvas canvas, ui.Size size) {
     Rect rect = Offset(0, 0) &amp; size;
     // è£å‰ªç»˜åˆ¶åŒºåŸŸ
     canvas.clipRect(rect);
     if (_img != null) {
       double showSize = _img.width.toDouble();
       // è®¡ç®—å°†è¦æ˜¾ç¤ºçš„åŒºåŸŸ
       Rect src = Rect.fromLTRB(
         0,
         _showIndex * showSize,
         showSize,
         (_showIndex + 1) * showSize,
       );
       // src: _imgå°†è¦æ˜¾ç¤ºçš„åŒºåŸŸ, rect: _imgå°†è¦æ˜¾ç¤ºçš„åŒºåŸŸå®é™…è¢«ç»˜åˆ¶çš„åŒºåŸŸ
       canvas.drawImageRect(_img, src, rect, mainPaint);
     }
   }

   @override
   bool shouldRepaint(CustomPainter oldDelegate) {
     if (oldDelegate is _SpritesPainter) {
       _SpritesPainter oldPainter = oldDelegate;
       if (oldPainter._showIndex != this._showIndex ||
           oldPainter.mainPaint != this.mainPaint) {
         return true;
       }
     }
     return false;
   }
 }</code></pre>
<p> å¦‚ä¸Š,æˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ª <code>_SpritesPainter</code> ç”¨æ¥ç»˜åˆ¶<code>ui.Image</code>æŒ‡å®šçš„åŒºåŸŸï¼›</p>
</li>
<li><p>å°† <code>// todo: add customPaint</code> æ›¿æ¢ä¸ºå¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="line-numbers language-dart"> child: CustomPaint(
   painter: _SpritesPainter(
     widget.img,
     showIndex: widget.showIndex,
   ),
 ),</code></pre>
</li>
<li><p>æ·»åŠ åˆ° <code>main.dart</code>ï¼Œåœ¨ <code>main.dart</code> ä¸­å°†å¦‚ä¸‹ä»£ç ï¼Œæ·»åŠ åˆ° <code>GridWidget()</code> ä¸‹æ–¹</p>
<pre><code class="line-numbers language-dart"> Container(
   margin: EdgeInsets.fromLTRB(16, 10, 16, 0),
   child: SubNavWidget(),
 ),</code></pre>
<p> ç„¶å <code>cmd</code> + <code>s</code> åï¼Œ<code>F5</code> è°ƒè¯•ï¼Œæ‚¨å°†çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š</p>
 <img width=375 src="https://github.com/gitKun/ctrip_gird_demo/blob/master/screenshort/sprites_test_show.png?raw=true">

<p> è¯•ç€æ›´æ”¹ <code>sub_nav_widget.dart</code> ä¸­ä¼ å…¥çš„ <code>showIndex</code> ï¼Œä½ å°†çœ‹åˆ°ä¸åŒçš„å›¾æ ‡è¢«ç»˜åˆ¶ï¼›</p>
</li>
<li><p>å¥½äº†è®©æˆ‘ä»¬å›åˆ° <code>sub_nav_widget.dart</code> æ·»åŠ å¦‚ä¸‹å¸ƒå±€ä»£ç ï¼š</p>
<pre><code class="line-numbers language-dart"> Widget _nomalItemExpanded(index, ui.Image img) {
   return Expanded(
     child: _itemContainer(index, img),
     flex: 1,
   );
 }

 Widget _itemExpandedWithNew(index, ui.Image img) {
   return Expanded(
     flex: 1,
     child: Stack(
       alignment: Alignment.center,
       children: &lt;Widget&gt;[
         _itemContainer(index, img),
         _newTagText(),
       ],
     ),
   );
 }

 Widget _newTagText() {
   return Positioned(
     top: 0,
     child: Container(
       padding: EdgeInsets.fromLTRB(4, 0, 4, 0),
       decoration: BoxDecoration(
         gradient:
             LinearGradient(colors: [Color(0xfff94242), Color(0xffffa25f)]),
         borderRadius: BorderRadius.circular(8),
       ),
       child: Text(
         &#39;NEW&#39;,
         style: TextStyle(
           color: Colors.white,
           fontSize: 10,
         ),
       ),
     ),
   );
 }

 Widget _itemContainer(index, ui.Image img) {
   return Container(
     height: 55,
     child: Column(
       children: &lt;Widget&gt;[
         SubNavSpritesImage(
           showIndex: index,
           img: img,
         ),
         Text(
           _names[index],
           style: TextStyle(
             color: Color(0xff222222),
             fontSize: 11,
           ),
         ),
       ],
     ),
   );
 }

 List&lt;Widget&gt; _rowContentList(int rowIdx, ui.Image img) {
   return List&lt;int&gt;.generate(_rowItemsNum, (i) =&gt; i + rowIdx * _rowItemsNum)
       .map((idx) {
     if (idx == 8) {
       return _itemExpandedWithNew(idx, img);
     }
     return _nomalItemExpanded(idx, img);
   }).toList();
 }

 Widget _rowItemContent(int rowIdx, ui.Image img) {
   if ((rowIdx + 1) * _rowItemsNum &gt; _names.length) {
     return null;
   }
   return Row(
     mainAxisAlignment: MainAxisAlignment.spaceBetween,
     children: _rowContentList(rowIdx, img),
   );
 }</code></pre>
</li>
<li><p>å¦‚ä¸Šï¼Œä»£ç é€»è¾‘å¾ˆç®€å•è¿™é‡Œä¸åšè¿‡å¤šè§£é‡Šï¼Œç„¶åå°† <code>// todo: modify column</code> æ›¿æ¢ä¸ºï¼š</p>
<pre><code class="line-numbers language-dart"> return Column(
   children: &lt;Widget&gt;[
     _rowItemContent(0, snapshot.data),
     _rowItemContent(1, snapshot.data),
   ],
 );</code></pre>
<p> <code>cmd</code> + <code>s</code> çƒ­æ›´æ–°åä½ å°†çœ‹åˆ°æœ€ç»ˆçš„æ•ˆæœï¼š</p>
 <img width=375 src="https://github.com/gitKun/ctrip_gird_demo/blob/master/screenshort/sprites_complet_new.png?raw=true">


</li>
</ol>
<p>æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚</p>
<h3 id="å½©è›‹"><a href="#å½©è›‹" class="headerlink" title="# å½©è›‹"></a># å½©è›‹</h3><p>æœ€ç»ˆæˆ‘æ‰¾åˆ°äº†é™ä½<code>Android Studio</code>å¯¹<code>CPU</code>å ç”¨çš„åŠæ³•(è™½ç„¶ç°åœ¨<code>CPU</code>æ¸©åº¦è¿˜åœ¨<code>67Â°</code>å·¦å³å¾˜å¾ŠğŸ˜…),è¯¦è§:<a href="https://stackoverflow.com/questions/19986498/android-studio-using-100-cpu-at-all-times-no-background-processes-appear-to" target="_blank" rel="noopener">ä¸‡èƒ½çš„stackoverflow</a>ã€‚</p>
<blockquote>
<p>Go to: Preferences &gt; Version Control &gt; Background. Now listed under â€˜Background Operationsâ€™ are 6 options. I disabled the first three options which are:</p>
<p>Perform update on VCS in background, Perform commit to VCS in background, Perform checkout to VCS in background.</p>
</blockquote>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04/10/Flutter%E5%AE%9E%E7%8E%B0%E6%90%BA%E7%A8%8BGirdNav%E5%B8%83%E5%B1%80_hotel%E5%B8%83%E5%B1%80/" rel="prev" title="æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°æºç¨‹GridNavå¸ƒå±€-hotelå¸ƒå±€">
      <i class="fa fa-chevron-left"></i> æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°æºç¨‹GridNavå¸ƒå±€-hotelå¸ƒå±€
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/04/20/%E5%9C%A8Flutter%E4%B8%AD%E5%AE%9E%E7%8E%B0%E8%B0%B7%E6%AD%8C%E7%81%AD%E9%9C%B8%E5%BD%A9%E8%9B%8B/" rel="next" title="Flutterä¸­ä½¿ç”¨ç²¾çµå›¾">
      Flutterä¸­ä½¿ç”¨ç²¾çµå›¾ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#æœ¬æ–‡æ”¶è·ä¸ä»·å€¼"><span class="nav-number">1.</span> <span class="nav-text"># æœ¬æ–‡æ”¶è·ä¸ä»·å€¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‡†å¤‡å·¥ä½œ"><span class="nav-number">2.</span> <span class="nav-text"># å‡†å¤‡å·¥ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#å¿…å¤‡æ¡ä»¶"><span class="nav-number">2.0.1.</span> <span class="nav-text">å¿…å¤‡æ¡ä»¶</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ·»åŠ -sub-nav-å’Œç›¸å…³èµ„æº"><span class="nav-number">2.0.2.</span> <span class="nav-text">æ·»åŠ  sub_nav å’Œç›¸å…³èµ„æº</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»£ç éƒ¨åˆ†"><span class="nav-number">3.</span> <span class="nav-text"># ä»£ç éƒ¨åˆ†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å½©è›‹"><span class="nav-number">4.</span> <span class="nav-text"># å½©è›‹</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CodingKun</p>
  <div class="site-description" itemprop="description">å–œæ¬¢æ–°æŠ€æœ¯ï¼Œä¸ºäº†æ›´å¥½åœ°è‡ªå·±åŠªåŠ›å·¥ä½œï¼</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CodingKun</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.0
  </div>

<script src="/js/prism/prism.js" async></script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      è®¿å®¢æ•°<span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>äººæ•°
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      æ€»è®¿é—®é‡<span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>æ¬¡
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
